C:\Users\Daniel-PC\PycharmProjects\cnn\venv\Scripts\python.exe C:/Users/Daniel-PC/PycharmProjects/cnn/venv/r3_darkcovidnet.py
2021-05-08 17:28:36.690864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
C:\Users\Daniel-PC\PycharmProjects\cnn\venv\lib\site-packages\keras_preprocessing\image\image_data_generator.py:349: UserWarning: This ImageDataGenerator specifies `featurewise_std_normalization`, which overrides setting of `featurewise_center`.
  warnings.warn('This ImageDataGenerator specifies '
3
Found 5984 images belonging to 3 classes.
Found 1490 images belonging to 3 classes.

Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 256, 256, 8)       224       
_________________________________________________________________
batch_normalization (BatchNo (None, 256, 256, 8)       32        
_________________________________________________________________
leaky_re_lu (LeakyReLU)      (None, 256, 256, 8)       0         
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 128, 128, 8)       0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 128, 128, 16)      1168      
_________________________________________________________________
batch_normalization_1 (Batch (None, 128, 128, 16)      64        
_________________________________________________________________
leaky_re_lu_1 (LeakyReLU)    (None, 128, 128, 16)      0         
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 64, 64, 16)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 64, 64, 32)        4640      
_________________________________________________________________
batch_normalization_2 (Batch (None, 64, 64, 32)        128       
_________________________________________________________________
leaky_re_lu_2 (LeakyReLU)    (None, 64, 64, 32)        0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 64, 64, 16)        4624      
_________________________________________________________________
batch_normalization_3 (Batch (None, 64, 64, 16)        64        
_________________________________________________________________
leaky_re_lu_3 (LeakyReLU)    (None, 64, 64, 16)        0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 64, 64, 32)        4640      
_________________________________________________________________
batch_normalization_4 (Batch (None, 64, 64, 32)        128       
_________________________________________________________________
leaky_re_lu_4 (LeakyReLU)    (None, 64, 64, 32)        0         
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 32, 32, 32)        0         
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 32, 32, 64)        18496     
_________________________________________________________________
batch_normalization_5 (Batch (None, 32, 32, 64)        256       
_________________________________________________________________
leaky_re_lu_5 (LeakyReLU)    (None, 32, 32, 64)        0         
_________________________________________________________________
conv2d_6 (Conv2D)            (None, 32, 32, 32)        18464     
_________________________________________________________________
batch_normalization_6 (Batch (None, 32, 32, 32)        128       
_________________________________________________________________
leaky_re_lu_6 (LeakyReLU)    (None, 32, 32, 32)        0         
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 32, 32, 64)        18496     
_________________________________________________________________
batch_normalization_7 (Batch (None, 32, 32, 64)        256       
_________________________________________________________________
leaky_re_lu_7 (LeakyReLU)    (None, 32, 32, 64)        0         
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 16, 16, 64)        0         
_________________________________________________________________
conv2d_8 (Conv2D)            (None, 16, 16, 128)       73856     
_________________________________________________________________
batch_normalization_8 (Batch (None, 16, 16, 128)       512       
_________________________________________________________________
leaky_re_lu_8 (LeakyReLU)    (None, 16, 16, 128)       0         
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 16, 16, 64)        73792     
_________________________________________________________________
batch_normalization_9 (Batch (None, 16, 16, 64)        256       
_________________________________________________________________
leaky_re_lu_9 (LeakyReLU)    (None, 16, 16, 64)        0         
_________________________________________________________________
conv2d_10 (Conv2D)           (None, 16, 16, 128)       73856     
_________________________________________________________________
batch_normalization_10 (Batc (None, 16, 16, 128)       512       
_________________________________________________________________
leaky_re_lu_10 (LeakyReLU)   (None, 16, 16, 128)       0         
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 8, 8, 128)         0         
_________________________________________________________________
conv2d_11 (Conv2D)           (None, 8, 8, 256)         295168    
_________________________________________________________________
batch_normalization_11 (Batc (None, 8, 8, 256)         1024      
_________________________________________________________________
leaky_re_lu_11 (LeakyReLU)   (None, 8, 8, 256)         0         
_________________________________________________________________
conv2d_12 (Conv2D)           (None, 8, 8, 128)         295040    
_________________________________________________________________
batch_normalization_12 (Batc (None, 8, 8, 128)         512       
_________________________________________________________________
leaky_re_lu_12 (LeakyReLU)   (None, 8, 8, 128)         0         
_________________________________________________________________
conv2d_13 (Conv2D)           (None, 8, 8, 256)         295168    
_________________________________________________________________
batch_normalization_13 (Batc (None, 8, 8, 256)         1024      
_________________________________________________________________
leaky_re_lu_13 (LeakyReLU)   (None, 8, 8, 256)         0         
_________________________________________________________________
conv2d_14 (Conv2D)           (None, 8, 8, 128)         295040    
_________________________________________________________________
batch_normalization_14 (Batc (None, 8, 8, 128)         512       
_________________________________________________________________
leaky_re_lu_14 (LeakyReLU)   (None, 8, 8, 128)         0         
_________________________________________________________________
conv2d_15 (Conv2D)           (None, 8, 8, 256)         295168    
_________________________________________________________________
batch_normalization_15 (Batc (None, 8, 8, 256)         1024      
_________________________________________________________________
leaky_re_lu_15 (LeakyReLU)   (None, 8, 8, 256)         0         
_________________________________________________________________
conv2d_16 (Conv2D)           (None, 8, 8, 3)           6915      
_________________________________________________________________
batch_normalization_16 (Batc (None, 8, 8, 3)           12        
_________________________________________________________________
flatten (Flatten)            (None, 192)               0         
_________________________________________________________________
dense (Dense)                (None, 3)                 579       
_________________________________________________________________
dense_1 (Dense)              (None, 3)                 12        
=================================================================
Total params: 1,781,790
Trainable params: 1,778,568
Non-trainable params: 3,222
_________________________________________________________________
------------------------------------------------------------------------
Training for fold1

Epoch 1/12
748/748 [==============================] - 178s 234ms/step - loss: 0.6454 - acc: 0.7463
Epoch 2/12
748/748 [==============================] - 177s 237ms/step - loss: 0.3074 - acc: 0.8862
Epoch 3/12
748/748 [==============================] - 176s 235ms/step - loss: 0.2592 - acc: 0.8982
Epoch 4/12
748/748 [==============================] - 177s 237ms/step - loss: 0.2245 - acc: 0.9185
Epoch 5/12
748/748 [==============================] - 175s 234ms/step - loss: 0.2166 - acc: 0.9254
Epoch 6/12
748/748 [==============================] - 175s 234ms/step - loss: 0.2047 - acc: 0.9269
Epoch 7/12
748/748 [==============================] - 180s 241ms/step - loss: 0.1938 - acc: 0.9301
Epoch 8/12
748/748 [==============================] - 175s 234ms/step - loss: 0.1855 - acc: 0.9324
Epoch 9/12
748/748 [==============================] - 176s 235ms/step - loss: 0.1735 - acc: 0.9369
Epoch 10/12
748/748 [==============================] - 174s 233ms/step - loss: 0.1709 - acc: 0.9401
Epoch 11/12
748/748 [==============================] - 174s 233ms/step - loss: 0.1675 - acc: 0.9395
Epoch 12/12
748/748 [==============================] - 175s 234ms/step - loss: 0.1800 - acc: 0.9332
Found 1490 images belonging to 3 classes.
1490/1490 [==============================] - 21s 14ms/step - loss: 0.2253 - acc: 0.9094
Test loss: 0.2252787947654724
Test accuracy: 0.9093959927558899

              precision    recall  f1-score   support

           0       0.97      0.97      0.97       320
           1       0.72      0.98      0.83       315
           2       0.99      0.86      0.92       855

    accuracy                           0.91      1490
   macro avg       0.89      0.94      0.91      1490
weighted avg       0.93      0.91      0.91      1490

------------------------------------------------------------------------
------------------------------------------------------------------------
Score per fold
------------------------------------------------------------------------
> Fold 1 - Loss: 0.2252787947654724 - Accuracy: 0.9093959927558899%
------------------------------------------------------------------------
Average scores for all folds:
> Accuracy: 0.9093959927558899 (+- 0.0)
> Loss: 0.2252787947654724
------------------------------------------------------------------------

Process finished with exit code 0
