C:\Users\Daniel-PC\PycharmProjects\cnn\venv\Scripts\python.exe C:/Users/Daniel-PC/PycharmProjects/cnn/r1_92.6_k-fold.py
2021-05-08 20:53:01.553755: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library cudart64_110.dll
3
C:\Users\Daniel-PC\PycharmProjects\cnn\venv\lib\site-packages\keras_preprocessing\image\image_data_generator.py:349: UserWarning: This ImageDataGenerator specifies `featurewise_std_normalization`, which overrides setting of `featurewise_center`.
  warnings.warn('This ImageDataGenerator specifies '
Found 5984 images belonging to 3 classes.
Found 1490 images belonging to 3 classes.

Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 150, 150, 32)      896       
_________________________________________________________________
batch_normalization (BatchNo (None, 150, 150, 32)      128       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 75, 75, 32)        0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 75, 75, 64)        18496     
_________________________________________________________________
dropout (Dropout)            (None, 75, 75, 64)        0         
_________________________________________________________________
batch_normalization_1 (Batch (None, 75, 75, 64)        256       
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 38, 38, 64)        0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 38, 38, 64)        36928     
_________________________________________________________________
batch_normalization_2 (Batch (None, 38, 38, 64)        256       
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 19, 19, 64)        0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 19, 19, 128)       73856     
_________________________________________________________________
dropout_1 (Dropout)          (None, 19, 19, 128)       0         
_________________________________________________________________
batch_normalization_3 (Batch (None, 19, 19, 128)       512       
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 10, 10, 128)       0         
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 10, 10, 256)       295168    
_________________________________________________________________
dropout_2 (Dropout)          (None, 10, 10, 256)       0         
_________________________________________________________________
batch_normalization_4 (Batch (None, 10, 10, 256)       1024      
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 5, 5, 256)         0         
_________________________________________________________________
flatten (Flatten)            (None, 6400)              0         
_________________________________________________________________
dense (Dense)                (None, 128)               819328    
_________________________________________________________________
dropout_3 (Dropout)          (None, 128)               0         
_________________________________________________________________
dense_1 (Dense)              (None, 3)                 387       
=================================================================
Total params: 1,247,235
Trainable params: 1,246,147
Non-trainable params: 1,088
_________________________________________________________________
------------------------------------------------------------------------
Training for fold1

Epoch 1/12
748/748 [==============================] - 120s 158ms/step - loss: 0.7490 - acc: 0.7357
Epoch 2/12
748/748 [==============================] - 115s 153ms/step - loss: 0.3388 - acc: 0.8736
Epoch 3/12
748/748 [==============================] - 114s 152ms/step - loss: 0.2975 - acc: 0.8899
Epoch 4/12
748/748 [==============================] - 114s 153ms/step - loss: 0.2667 - acc: 0.9031
Epoch 5/12
748/748 [==============================] - 114s 153ms/step - loss: 0.2517 - acc: 0.9053
Epoch 6/12
748/748 [==============================] - 114s 153ms/step - loss: 0.2482 - acc: 0.9133
Epoch 7/12
748/748 [==============================] - 114s 153ms/step - loss: 0.2209 - acc: 0.9213
Epoch 8/12
748/748 [==============================] - 113s 152ms/step - loss: 0.2192 - acc: 0.9220
Epoch 9/12
748/748 [==============================] - 113s 151ms/step - loss: 0.2040 - acc: 0.9284
Epoch 10/12
748/748 [==============================] - 114s 152ms/step - loss: 0.1872 - acc: 0.9322
Epoch 11/12
748/748 [==============================] - 114s 152ms/step - loss: 0.1904 - acc: 0.9350
Epoch 12/12
748/748 [==============================] - 113s 151ms/step - loss: 0.1855 - acc: 0.9332
Found 1490 images belonging to 3 classes.
1490/1490 [==============================] - 23s 15ms/step - loss: 0.6693 - acc: 0.7369
Test loss: 0.6692661046981812
Test accuracy: 0.736912727355957

              precision    recall  f1-score   support

           0       0.66      0.97      0.78       320
           1       0.55      0.89      0.68       315
           2       0.99      0.59      0.74       855

    accuracy                           0.74      1490
   macro avg       0.73      0.82      0.74      1490
weighted avg       0.83      0.74      0.74      1490

------------------------------------------------------------------------
Found 5984 images belonging to 3 classes.
Found 1490 images belonging to 3 classes.
------------------------------------------------------------------------
Training for fold2

Epoch 1/12
748/748 [==============================] - 122s 162ms/step - loss: 0.6963 - acc: 0.7571
Epoch 2/12
748/748 [==============================] - 118s 158ms/step - loss: 0.3395 - acc: 0.8688
Epoch 3/12
748/748 [==============================] - 120s 160ms/step - loss: 0.2831 - acc: 0.8981
Epoch 4/12
748/748 [==============================] - 118s 158ms/step - loss: 0.2353 - acc: 0.9131
Epoch 5/12
748/748 [==============================] - 119s 158ms/step - loss: 0.2274 - acc: 0.9121
Epoch 6/12
748/748 [==============================] - 118s 157ms/step - loss: 0.2129 - acc: 0.9189
Epoch 7/12
748/748 [==============================] - 119s 159ms/step - loss: 0.1984 - acc: 0.9262
Epoch 8/12
748/748 [==============================] - 119s 159ms/step - loss: 0.1876 - acc: 0.9317
Epoch 9/12
748/748 [==============================] - 118s 157ms/step - loss: 0.1788 - acc: 0.9340
Epoch 10/12
748/748 [==============================] - 119s 159ms/step - loss: 0.1805 - acc: 0.9372
Epoch 11/12
748/748 [==============================] - 118s 158ms/step - loss: 0.1445 - acc: 0.9474
Epoch 12/12
748/748 [==============================] - 120s 160ms/step - loss: 0.1490 - acc: 0.9482
Found 1490 images belonging to 3 classes.
1490/1490 [==============================] - 19s 13ms/step - loss: 0.2282 - acc: 0.9282
Test loss: 0.22820791602134705
Test accuracy: 0.928187906742096

              precision    recall  f1-score   support

           0       0.99      0.97      0.98       320
           1       0.88      0.80      0.84       315
           2       0.92      0.96      0.94       855

    accuracy                           0.93      1490
   macro avg       0.93      0.91      0.92      1490
weighted avg       0.93      0.93      0.93      1490

------------------------------------------------------------------------
Found 5983 images belonging to 3 classes.
Found 1490 images belonging to 3 classes.
------------------------------------------------------------------------
Training for fold3

Epoch 1/12
747/747 [==============================] - 115s 152ms/step - loss: 0.6649 - acc: 0.7490
Epoch 2/12
747/747 [==============================] - 114s 152ms/step - loss: 0.3388 - acc: 0.8717
Epoch 3/12
747/747 [==============================] - 113s 151ms/step - loss: 0.2780 - acc: 0.8943
Epoch 4/12
747/747 [==============================] - 113s 152ms/step - loss: 0.2495 - acc: 0.9092
Epoch 5/12
747/747 [==============================] - 113s 151ms/step - loss: 0.2464 - acc: 0.9032
Epoch 6/12
747/747 [==============================] - 112s 150ms/step - loss: 0.2219 - acc: 0.9198
Epoch 7/12
747/747 [==============================] - 113s 152ms/step - loss: 0.2103 - acc: 0.9247
Epoch 8/12
747/747 [==============================] - 112s 150ms/step - loss: 0.2170 - acc: 0.9247
Epoch 9/12
747/747 [==============================] - 112s 150ms/step - loss: 0.1981 - acc: 0.9283
Epoch 10/12
747/747 [==============================] - 112s 150ms/step - loss: 0.1873 - acc: 0.9304
Epoch 11/12
747/747 [==============================] - 115s 154ms/step - loss: 0.1748 - acc: 0.9383
Epoch 12/12
747/747 [==============================] - 115s 154ms/step - loss: 0.1976 - acc: 0.9298
Found 1490 images belonging to 3 classes.
1490/1490 [==============================] - 21s 14ms/step - loss: 0.4475 - acc: 0.8255
Test loss: 0.44746893644332886
Test accuracy: 0.8255033493041992

              precision    recall  f1-score   support

           0       0.88      0.91      0.89       320
           1       0.59      1.00      0.74       315
           2       1.00      0.73      0.84       855

    accuracy                           0.83      1490
   macro avg       0.82      0.88      0.83      1490
weighted avg       0.89      0.83      0.83      1490

------------------------------------------------------------------------
Found 5981 images belonging to 3 classes.
Found 1493 images belonging to 3 classes.
------------------------------------------------------------------------
Training for fold4

Epoch 1/12
747/747 [==============================] - 116s 155ms/step - loss: 0.6467 - acc: 0.7540
Epoch 2/12
747/747 [==============================] - 114s 153ms/step - loss: 0.3428 - acc: 0.8716
Epoch 3/12
747/747 [==============================] - 127s 169ms/step - loss: 0.2817 - acc: 0.8960
Epoch 4/12
747/747 [==============================] - 110s 148ms/step - loss: 0.2440 - acc: 0.9095
Epoch 5/12
747/747 [==============================] - 112s 150ms/step - loss: 0.2152 - acc: 0.9182
Epoch 6/12
747/747 [==============================] - 111s 149ms/step - loss: 0.2091 - acc: 0.9294
Epoch 7/12
747/747 [==============================] - 111s 148ms/step - loss: 0.2224 - acc: 0.9223
Epoch 8/12
747/747 [==============================] - 114s 152ms/step - loss: 0.2030 - acc: 0.9218
Epoch 9/12
747/747 [==============================] - 111s 149ms/step - loss: 0.1939 - acc: 0.9322
Epoch 10/12
747/747 [==============================] - 111s 148ms/step - loss: 0.1785 - acc: 0.9317
Epoch 11/12
747/747 [==============================] - 111s 148ms/step - loss: 0.1581 - acc: 0.9450
Epoch 12/12
747/747 [==============================] - 111s 148ms/step - loss: 0.1662 - acc: 0.9421
Found 1493 images belonging to 3 classes.
1493/1493 [==============================] - 23s 15ms/step - loss: 0.4666 - acc: 0.8131
Test loss: 0.46655309200286865
Test accuracy: 0.8131279349327087

              precision    recall  f1-score   support

           0       0.98      0.84      0.90       320
           1       0.55      1.00      0.71       318
           2       0.98      0.73      0.84       855

    accuracy                           0.81      1493
   macro avg       0.84      0.86      0.82      1493
weighted avg       0.89      0.81      0.83      1493

------------------------------------------------------------------------
Found 5962 images belonging to 3 classes.
Found 1511 images belonging to 3 classes.
------------------------------------------------------------------------
Training for fold5

Epoch 1/12
745/745 [==============================] - 119s 159ms/step - loss: 0.7215 - acc: 0.7488
Epoch 2/12
745/745 [==============================] - 112s 150ms/step - loss: 0.3644 - acc: 0.8632
Epoch 3/12
745/745 [==============================] - 113s 152ms/step - loss: 0.2971 - acc: 0.8794
Epoch 4/12
745/745 [==============================] - 117s 158ms/step - loss: 0.2711 - acc: 0.9048
Epoch 5/12
745/745 [==============================] - 112s 150ms/step - loss: 0.2354 - acc: 0.9187
Epoch 6/12
745/745 [==============================] - 113s 152ms/step - loss: 0.2466 - acc: 0.9082
Epoch 7/12
745/745 [==============================] - 112s 150ms/step - loss: 0.2251 - acc: 0.9201
Epoch 8/12
745/745 [==============================] - 112s 151ms/step - loss: 0.2200 - acc: 0.9211
Epoch 9/12
745/745 [==============================] - 111s 148ms/step - loss: 0.1810 - acc: 0.9341
Epoch 10/12
745/745 [==============================] - 111s 149ms/step - loss: 0.1907 - acc: 0.9304
Epoch 11/12
745/745 [==============================] - 111s 150ms/step - loss: 0.1920 - acc: 0.9317
Epoch 12/12
745/745 [==============================] - 112s 150ms/step - loss: 0.1901 - acc: 0.9305
Found 1511 images belonging to 3 classes.
1511/1511 [==============================] - 21s 14ms/step - loss: 1.5271 - acc: 0.5420
Test loss: 1.5271472930908203
Test accuracy: 0.5420251488685608

              precision    recall  f1-score   support

           0       0.91      0.91      0.91       339
           1       0.33      1.00      0.49       319
           2       0.99      0.22      0.37       853

    accuracy                           0.54      1511
   macro avg       0.74      0.71      0.59      1511
weighted avg       0.83      0.54      0.51      1511

------------------------------------------------------------------------
------------------------------------------------------------------------
Score per fold
------------------------------------------------------------------------
> Fold 1 - Loss: 0.6692661046981812 - Accuracy: 0.736912727355957%
------------------------------------------------------------------------
> Fold 2 - Loss: 0.22820791602134705 - Accuracy: 0.928187906742096%
------------------------------------------------------------------------
> Fold 3 - Loss: 0.44746893644332886 - Accuracy: 0.8255033493041992%
------------------------------------------------------------------------
> Fold 4 - Loss: 0.46655309200286865 - Accuracy: 0.8131279349327087%
------------------------------------------------------------------------
> Fold 5 - Loss: 1.5271472930908203 - Accuracy: 0.5420251488685608%
------------------------------------------------------------------------
Average scores for all folds:
> Accuracy: 0.7691514134407044 (+- 0.1288625269492027)
> Loss: 0.6677286684513092
------------------------------------------------------------------------

Process finished with exit code 0
